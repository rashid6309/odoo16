<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <data>
        <!-- Explicit Search View -->

        <record id="ec_medical_patient_search_view" model="ir.ui.view">
            <field name="name">ec.patient.view.search</field>
            <field name="model">ec.medical.patient</field>
            <field name="arch" type="xml">
                <search string="Search Patients">
                    <field name="name"/>
                    <field name="mr_num"/>

                    <field name="wife_name"
                           string="Wife Name"/>

                    <field name="husband_name"
                           string="Husband Name"/>

                    <field name="wife_nic"
                           string="Wife CNIC"/>

                    <field name="husband_nic"
                           string="Husband CNIC"/>

                    <field name="mobile_wife"
                           string="Wife Mobile"/>
                    <field name="mobile_husband"
                           string="Husband Mobile"/>

                    <field name="wife_passport"
                           string="Wife Passport"/>
                    <field name="husband_passport"
                           string="Husband Passport"/>
                    <separator/>
                    <!--                    <filter string="Archived" name="inactive" domain="[('active', '=', False)]"/>-->
                </search>
            </field>
        </record>

        <!-- Kanban View -->
        <record id="ec_patient_kanban_view" model="ir.ui.view">
            <field name="name">ec.medical.patient.kanban.view</field>
            <field name="model">ec.medical.patient</field>
            <field name="priority">1</field>
            <field name="arch" type="xml">
                <kanban class="o_kanban_mobile">
                    <field name="mr_num"/>
                    <field name="name"/>
                    <field name="wife_age"/>
                    <field name="marital_status"/>
                    <field name="image_1920"/>
                    <templates>
                        <t t-name="kanban-box">
                            <div t-attf-class="oe_kanban_content oe_kanban_global_click">
                                <group style="margin:2%;">
                                    <field name="image_1920" widget="image"
                                           options='{"size": [128, 128],"zoom": true, "zoom_delay": 1000 }'
                                           class="bg-view"/>
                                </group>

                                <group  style="margin:2%;">
                                    <field name="husband_image" widget="image"
                                           options='{"size": [128, 128],"zoom": true, "zoom_delay": 1000 }'
                                           class="bg-view"/>
                                </group>

                                <p style="margin:2%; font-weight: 700;">
                                    <field name="name" t-if="record.mr_num.value == '' "/>
                                    <field name="mr_num" t-if="record.mr_num.value != ''"/>
                                </p>

                                <hr/>
                                <group>

                                    <group style="width: 50%; float:left;">
                                        <span style="font-weight: 650;">Wife:</span> <field name="wife_name"/>

                                        <br/>
                                        <t t-if="mobile_wife != ''">
                                            <span style="font-weight: 650;">Mobile:</span> <field name="mobile_wife"/>
                                        </t>
                                    </group>

                                    <group style="width: 50%;">
                                        <span style="font-weight: 650;">Husband:</span> <field name="husband_name"/>

                                        <br/>
                                        <t t-if="mobile_husband != ''">
                                            <span style="font-weight: 650;">Mobile:</span><field name="mobile_husband"/>
                                        </t>

                                        <br/>
                                    </group>

                                </group>
                            </div>
                        </t>
                    </templates>
                </kanban>
            </field>
        </record>

        <!-- Explicit Tree view -->
        <record id="ec_patient_tree_view" model="ir.ui.view">
            <field name="name">ec.medical.patient.tree.view</field>
            <field name="model">ec.medical.patient</field>
            <field name="arch" type="xml">
                <tree decoration-danger="(wife_nic or wife_passport) == False">
                    <field name="mr_num"/>
                    <field name="name"/>
                    <field name="wife_name" string="Wife Name"/>
                    <field name="mobile_wife" string="Wife Mobile"/>
                    <field name="wife_nic" string="Wife CNIC"/>
                    <field name="wife_passport" string="Wife CNIC"/>
                    <field name="husband_name" string="Husband Name"/>
                    <field name="mobile_husband" string="Husband Mobile"/>
                    <field name="husband_nic" string="Husband CNIC"/>
                    <field name="husband_passport" string="Husband CNIC"/>
                    <field name="write_date"/>
                    <field name="write_uid"/>
                </tree>
            </field>
        </record>

        <!-- Explicit form view -->
        <record id="ec_patient_form_view" model="ir.ui.view">
            <field name="name">ec.medical.patient.form.view</field>
            <field name="model">ec.medical.patient</field>
            <field name="arch" type="xml">
                <form>
                    <header>
                        <button name="action_register"
                                type="object"
                                string="Generate MR No"
                                class="btn btn-primary"
                                attrs="{'invisible': ['|', ('mr_num', '!=', False),
                                                      ('id', '==', False)]}"
                        />
                    </header>
                    <sheet>
                        <div class="oe_button_box" name="button_box">
                            <button style="float: right;"
                                    name="action_open_patient_slots"
                                    type="object" class="oe_highlight" string="Appointments"/>
                            <button style="float: right;"
                                    name="action_open_patient_invoices"
                                    type="object" class="oe_highlight" string="Invoices"/>

                        </div>
                        <group>
                            <group>
                                <field name="mr_num"
                                       readonly="True"
                                       force_save="True"
                                />

                                <field name="name"
                                       string="Patient Name"
                                       readonly="1"
                                       invisible="0"
                                       force_save="1"/>

                            </group>
                            <group>

                            </group>
                            <group string="Wife Details"
                                   attrs="{'invisible': [('husband_marital_status', '=', 'Unmarried')]}">

                                <field name="image_1920"
                                       string="Wife Photo ID"
                                       widget="image" class="oe_avatar"
                                       options="{&quot;preview_image&quot;: &quot;avatar_256&quot; 'size':[256, 256],
                                       'zoom': true, 'zoom_delay': 1000 }"/>

                                <field name="wife_name"
                                       attrs="{'required': [('husband_marital_status', '=', 'Married')]}"/>

                                <field name="wife_nic"
                                       attrs="{'required': [
                                       ('husband_marital_status', '=', 'Married'),
                                       ('wife_passport', '=', False)]}"/>

                                <field name="wife_passport"
                                       attrs="{'required': [
                                       ('husband_marital_status', '=', 'Married'),
                                       ('wife_nic', '=', False)]}"/>

                                <field name="wife_driving_license"/>
                                <field name="wife_dob"/>

                                <field name="wife_age"
                                       readonly="1"
                                       force_save="1"/>

                                <field name="phone_res_wife"/>
                                <field name="phone_ofc_wife"/>
                                <field name="mobile_wife"
                                       attrs="{'required': [('husband_marital_status', '=', 'Married')]}"/>

                                <field name="email_wife"/>
                                <field name="marital_status"
                                       required="True"/>

                                <field name="married_since"/>
                            </group>

                            <group string="Husband Details"
                                   attrs="{'invisible': [('marital_status', '=', 'Unmarried')]}">
                                <field name="husband_image"
                                       widget="image"
                                       class="oe_avatar"
                                       string="Husband Photo ID"
                                       options="{'size':[256, 256], 'zoom': true, 'zoom_delay': 1000}"/>


                                <field name="husband_name"
                                       attrs="{'required': [('marital_status', '=', 'Married')]}"/>
                                />

                                <field name="husband_nic"
                                       attrs="{'required': [
                                       ('marital_status', '=', 'Married'),
                                       ('husband_passport', '=', False)]}"/>
                                />

                                <field name="husband_passport"
                                       attrs="{'required': [
                                               ('marital_status', '=', 'Married'),
                                               ('husband_nic', '=', False)]}"/>
                                />

                                <field name="husband_driving_license"/>
                                <field name="husband_dob"/>
                                <field name="husband_age" readonly="1" force_save="1"/>
                                <field name="phone_res_husband"/>
                                <field name="phone_ofc_husband"/>
                                <field name="mobile_husband"
                                       attrs="{'required': [('marital_status', '=', 'Married')]}"/>
                                />
                                <field name="email_husband"/>

                                <field name="husband_marital_status"
                                       attrs="{'required': [('marital_status', '=', 'Married')]}"/>
                                />
                            </group>
                        </group>
                        <group>
                            <field name="yom" readonly="1" force_save="1"/>
                        </group>
                        <group string="Preferred Contact Details" name="preferred_contact_detail">
                            <group>
                                <field name="preferred_mobile" required="False"/>
                            </group>
                        </group>
                        <group string="Address">
                            <field name="type"
                                   invisible="1"
                                   force_save="1"/>

                            <field name="parent_id"
                                   invisible="1"
                                   force_save="1"/>
                        </group>
                        <group>
                            <group>
                                <field name="street"
                                       string="STREET"
                                       required="True"
                                       placeholder="Street..."
                                       class="o_address_street"
                                       attrs="{'readonly': [('type', '=', 'contact'),('parent_id', '!=', False)]}"/>

                                <field name="street2"
                                       string="STREET2"
                                       required="True"
                                       placeholder="Street 2..."
                                       class="o_address_street"
                                       attrs="{'readonly': [('type', '=', 'contact'),('parent_id', '!=', False)]}"/>

                                <field name="city"
                                       string="CITY"
                                       required="True"
                                       placeholder="City"
                                       class="o_address_city"
                                       attrs="{'readonly': [('type', '=', 'contact'),('parent_id', '!=', False)]}"/>
                            </group>

                            <group>
                                <field name="state_id" class="o_address_state" placeholder="State"
                                       options="{'no_open': True, 'no_quick_create': True}" attrs="{'readonly': [('type', '=', 'contact'),('parent_id', '!=', False)]}" context="{'country_id': country_id, 'default_country_id': country_id, 'zip': zip}"/>
                                <field name="zip" placeholder="ZIP" class="o_address_zip" attrs="{'readonly': [('type', '=', 'contact'),('parent_id', '!=', False)]}"/>
                                <field name="country_id" placeholder="Country" class="o_address_country" options="{&quot;no_open&quot;: True, &quot;no_create&quot;: True}" attrs="{'readonly': [('type', '=', 'contact'),('parent_id', '!=', False)]}"/>
                            </group>
                        </group>
                        <group>
                            <group string="Next of Kin Details" name="next_of_kin">
                                <field name="emer_contact_name"/>
                                <field name="emer_contact_addr"/>
                                <field name="emer_contact_relation"/>
                                <field name="emer_contact_nic"/>
                            </group>
                            <group string="Parent Details (If Patient is a Minor/Unmarried/Single)" name="parent_detail">
                                <field name="father_name"/>
                                <field name="father_nic"/>
                                <field name="mother_name"/>
                                <field name="mobile_number"/>
                            </group>
                        </group>
                    </sheet>

                    <div class="oe_chatter">
                        <field name="message_follower_ids" groups="base.group_user"/>
                        <field name="message_ids"/>
                    </div>
                </form>
            </field>

        </record>

        <!-- Explicit action -->
        <record id="ec_patient_action" model="ir.actions.act_window">
            <field name="name">Patient</field>
            <field name="res_model">ec.medical.patient</field>
            <field name="view_mode">kanban,tree,form</field>
            <field name="target">current</field>
            <field name="search_view_id" ref="ec_medical_patient_search_view"/>
        </record>

        <!-- Menu item-->
    </data>
</odoo>