<?xml version="1.0" encoding="UTF-8" ?>
<odoo>
    <data>

        <!-- Kanban view -->

        <!-- Explicit Form Action -->

        <record id="ec_semen_analysis_form_view" model="ir.ui.view">
            <field name="name">ec.semen.analysis.form.view</field>
            <field name="model">ec.semen.analysis</field>
            <field name="arch" type="xml">
                <form>
                    <span id="semen_analysis_form_id">
                        <div style="margin-top: -2%;">
                            <field name="semen_patient_id" style="display:block;" widget="banner_summary_widget"/>
                        </div>
                        <group>
                            <group>
                                <field name="semen_patient_id"
                                       options="{'no_create': True, 'no_open': True, 'no_quick_create': True}"/>
                                <field name="date"  style="width:25% !important;"/>
                                <field name="lab_number" style="width:25% !important;" force_save="1"/>
                                <field name="lab_name"  style="width:25% !important;" options="{'no_create': True, 'no_open': True, 'no_quick_create': True}"/>
                                <field name="preparation_ids"  widget="many2many_checkboxes"/>
                                <field name="sample_produced_at_lab" widget="radio" options="{'horizontal': True}"/>
                                <field name="repeat_semen_analysis" widget="radio" options="{'horizontal': True}"/>
                                <field name="freezing" widget="radio" options="{'horizontal': True}"/>
                            </group>
                            <group>
                                <field name="all_semen_analysis_ids" nolabel="1">
                                    <tree create="0" edit="0" class="table_fixed_height">
                                        <field name="date"/>
                                        <field name="lab_number"/>
                                        <field name="lab_name"/>
                                        <button name="print_semen_analysis_report"
                                                type="object"
                                                string="Print"
                                                class="repeat_kanban_button"/>
                                        <button name="edit_semen_analysis_record"
                                                type="object"
                                                string="Edit"
                                                class="repeat_kanban_button"/>
                                        <button name="delete_semen_analysis_record"
                                                type="object"
                                                string="Delete"
                                                class="repeat_kanban_button"/>
                                    </tree>
                                </field>
                            </group>
                        </group>



                        <div class="d-flex ">
                            <div class="col-md-1" style=" margin-right: 2rem; ">
                                <label for="abstinence"/>
                            </div>
                            <div class="d-flex">
                                <div>
                                    <field name="abstinence" />
                                </div>
                                <div>
                                    <div><span>days</span> <span>(Range: 3-5 days)</span></div>
                                </div>
                            </div>
                        </div>

                        <group>
                            <group>
                                <field name="production_time"  style="width:25% !important;"/>
                                <field name="analysis_time"  style="width:25% !important;"/>
                            </group>
                        </group>
                        <group string="General Examination"/>
                        <div class="d-flex ">
                            <div class="col-md-1" style=" margin-right: 2rem; ">
                                <label for="liquifaction_time"/>
                            </div>
                            <div class="d-flex">
                                <div>
                                    <field name="liquifaction_time"/>
                                </div>
                                <div>
                                    <div>min</div>
                                </div>
                            </div>
                        </div>

                        <group>
                            <group>
                                <field style="width:25% !important;" name="color"/>
                            </group>
                        </group>

                        <div class="d-flex ">
                            <div class="col-md-1" style=" margin-right: 2rem; ">
                                <label for="ph"/>
                            </div>
                            <div class="d-flex">
                                <div>
                                    <field name="ph"/>
                                </div>
                                <div>
                                    <div>(Range: 7.2-8.2)</div>
                                </div>
                            </div>
                        </div>

                        <div class="d-flex ">
                            <div class="col-md-1" style=" margin-right: 2rem; ">
                                <label for="viscosity"/>
                            </div>
                            <div class="d-flex">
                                <div>
                                    <field name="viscosity"/>
                                </div>
                            </div>
                        </div>

                        <div class="d-flex ">
                            <div class="col-md-1" style=" margin-right: 2rem; ">
                                <label for="volume"/>
                            </div>
                            <div class="d-flex">
                                <div>
                                    <field name="volume"/>
                                </div>
                                <div>
                                    <div>ml (Range: 1.5-5 ml)</div>
                                </div>
                            </div>
                        </div>

                        <group string="Makler Chamber"/>
                        <div class="d-flex ">
                            <div class="col-md-1" style=" margin-right: 2rem; ">
                                <label for="total_count"/>
                            </div>
                            <div class="d-flex">
                                <div>
                                    <field name="total_count"/>
                                </div>
                                <div>
                                    <div>million/ml (Range: ≥ 15 million/ml)</div>
                                </div>
                            </div>
                        </div>


                        <div class="d-flex ">
                            <div class="col-md-1" style=" margin-right: 2rem; ">
                                <label for="motility"/>
                            </div>
                            <div class="d-flex">
                                <div>
                                    <field name="motility"/>
                                </div>
                                <div>
                                    <div>% (Range: ≥ 40 %)</div>
                                </div>
                            </div>
                        </div>

                        <!--    progression-->
                        <group string="Progression Slide"/>
                        <div class="d-flex flex-column col-lg-7">
                            <div class="d-flex align-items-center bg-light bg-gradient">
                                <div class="col-md-1">
                                    Progression
                                </div>
                                <div class="col-md-11 ">
                                    <div class="d-flex">
                                        <label for="progression_f_forward"/>
                                        <field name="progression_f_forward"/>
                                        <span>%</span>
                                    </div>
                                    <div class="d-flex">
                                        <label for="progression_s_forward"/>
                                        <field name="progression_s_forward"/>
                                        <span>%</span>
                                    </div>
                                    <div class="d-flex">
                                        <label for="progression_lateral"/>
                                        <field name="progression_lateral"/>
                                        <span>%</span>
                                    </div>
                                    <div class="d-flex">
                                        <label for="progression_non_progressive"/>
                                        <field name="progression_non_progressive"/>
                                        <span>%</span>
                                    </div>
                                    <div class="d-flex">
                                        <label for="progression_dead"/>
                                        <field name="progression_dead"/>
                                        <span>%</span>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <div class="d-flex ">
                            <div class="col-md-1" style=" margin-right: 2rem; ">
                                <label for="wbcs"/>
                            </div>
                            <div class="d-flex">
                                <div>
                                    <field name="wbcs"/>
                                </div>
                                <div>
                                    <div>/HPF (Range: 06 - 10 /HPF)</div>
                                </div>
                            </div>
                        </div>


                        <group>
                            <group>
                                <field name="agglutination" widget="radio" options="{'horizontal': True}"/>
                                <field name="debris" widget="radio" options="{'horizontal': True}"/>
                                <field name="bacteria" widget="radio" options="{'horizontal': True}"/>
                                <!--                            Unit is missing for below field will add later-->
                            </group>
                        </group>
                        <div class="d-flex ">
                            <div class="col-md-1" style=" width: 10%; ">
                                <label for="epi_cells_immature_cells"/>
                            </div>
                            <div class="d-flex">
                                <div>
                                    <field name="epi_cells_immature_cells"/>
                                </div>
                                <div>
                                    <div>/HPF</div>
                                </div>
                            </div>
                        </div>

                        <group>
                            <group>
                                <field name="other_observation" style="background: #ebebeb;"/>
                            </group>
                        </group>
                        <group string="Sperm Morphology"/>
                        <div class="d-flex ">
                            <div class="col-md-1">
                                <label for="normal"/>
                            </div>
                            <div class="d-flex">
                                <div>
                                    <field name="normal"/>
                                </div>
                                <div>
                                    <span>%</span>
                                    <span>  (Range > 5 %)</span>
                                </div>
                            </div>
                        </div>
                        <div class="d-flex ">
                            <div class="col-md-1">
                                <label for="abnormal"/>
                            </div>
                            <div class="d-flex">
                                <div>
                                    <field name="abnormal"/>
                                </div>
                                <div>
                                    <span>%</span>
                                </div>
                            </div>
                        </div>
                        <!--    Defects-->
                        <div class="d-flex flex-column col-lg-7">
                            <div class="d-flex align-items-center bg-light bg-gradient">
                                <div class="col-md-1">
                                    Defects
                                </div>
                                <div class="col-md-9">
                                    <div class="d-flex">
                                        <label for="cephalic"/>
                                        <field name="cephalic"/>
                                        <span>%</span>
                                    </div>
                                    <div class="d-flex">
                                        <label for="mid_piece"/>
                                        <field name="mid_piece"/>
                                        <span>%</span>
                                    </div>
                                    <div class="d-flex">
                                        <label for="tail"/>
                                        <field name="tail"/>
                                        <span>%</span>
                                    </div>
                                    <div class="d-flex">
                                        <label for="acrosomal_cap"/>
                                        <field name="acrosomal_cap"/>
                                        <span>%</span>
                                    </div>
                                    <div class="d-flex">
                                        <label for="vacoules"/>
                                        <field name="vacoules"/>
                                        <span>%</span>
                                    </div>
                                </div>
                            </div>

                        </div>
                        <group string="Preparation Method">
                            <group>
                                <field style="width:25% !important;" name="method"/>
                            </group>
                        </group>

                        <div class="d-flex">
                            <div class="col-md-1" style="margin-right: 2rem;">
                                <label for="prep_conc"/>
                            </div>
                            <div class="d-flex">
                                <div>
                                    <field name="prep_conc"/>
                                </div>
                                <div>
                                    <div>million/ejaculate </div>
                                </div>
                            </div>
                        </div>

                        <div class="d-flex ">
                            <div class="col-md-1" style="margin-right: 2rem;">
                                <label for="motility_percentage"/>
                            </div>
                            <div class="d-flex">
                                <div>
                                    <field name="motility_percentage"/>
                                </div>
                                <div>
                                    <div>%</div>
                                </div>
                            </div>
                        </div>

                        <div class="d-flex ">
                            <div class="col-md-1" style="margin-right: 2rem;">
                                <label for="progression"/>
                            </div>
                            <div class="d-progression">
                                <div>
                                    <field name="progression"/>
                                </div>
                            </div>
                        </div>

                        <div class="d-flex ">
                            <div class="col-md-1" style="margin-right: 2rem;">
                                <label for="after_24_hrs_motility_percentage"/>
                            </div>
                            <div class="d-flex">
                                <div>
                                    <field name="after_24_hrs_motility_percentage"/>
                                </div>
                                <div>
                                    <div>%</div>
                                </div>
                            </div>
                        </div>

                        <div class="d-flex ">
                            <div class="col-md-1" style="margin-right: 2rem;">
                                <label for="after_24_hrs_progression"/>
                            </div>
                            <div class="d-flex">
                                <div>
                                    <field name="after_24_hrs_progression"/>
                                </div>
                            </div>
                        </div>
                        <group col="4">
                            <field name="comments" style="background: #ebebeb;"/>
                        </group>

<!--                        <div class="d-flex ">-->
<!--                            <div class="col-md-1">-->
<!--                                <label for="comments"/>-->
<!--                            </div>-->
<!--                            <div class="d-flex col-md-10">-->
<!--                                <div>-->
<!--                                    <field name="comments"/>-->
<!--                                </div>-->
<!--                            </div>-->
<!--                        </div>-->
                        <group>
                            <field name="suitable_for_ids" widget="many2many_checkboxes"/>
                        </group>

                        <div class="d-flex flex-column col-lg-8">
                            <div class="d-flex align-items-center bg-light bg-gradient">
                                <div class="col-md-2">
                                    Sperm Cryopreservation
                                </div>
                                <div class="col-md-12 ">
                                    <div class="d-flex align-items-center">
                                        <field class="mb-0" name="sperm_cryopreservation_recommended"/>
                                        <label for="sperm_cryopreservation_recommended" string="Recommended"/>
                                    </div>
                                    <div class="d-flex align-items-center">
                                        <field class="mb-0" name="sperm_cryopreservation_consented"/>
                                        <label for="sperm_cryopreservation_consented" string="Consented"/>
                                        <label for="sperm_cryopreservation_strawe" string="No. Of Straws"/>
                                        <field name="sperm_cryopreservation_strawe"/>
                                        <label for="sperm_cryopreservation_code" string="Storage Code"/>
                                        <field name="sperm_cryopreservation_code"/>
                                    </div>
                                </div>
                            </div>

                        </div>

                        <group string="Additional Info" class="semen_analysis_div">
                            <group>
                                <field style="width:40% !important;" name="seminologist_ids" widget="many2many_tags"
                                       options="{'no_open': True, 'no_create': True}"
                                       force_save="1"/>
                                <field name="semen_diagnosis_id"
                                        style="width:25% !important;"
                                       options="{'no_open': True, 'no_create': True}"/>
                                <field name="special_notes" style="background: #ebebeb;"/>
                            </group>
                        </group>
                    </span>
                </form>
            </field>
        </record>

        <record id="ec_semen_analysis_tree_view" model="ir.ui.view">
            <field name="name">ec.semen.analysis.tree.view</field>
            <field name="model">ec.semen.analysis</field>
            <field name="arch" type="xml">
                <tree>
                    <field name="semen_patient_id"/>
                    <field name="date"/>
                    <field name="lab_number"/>
                    <field name="lab_name"/>
                    <field name="preparation_ids" string="Type of analysis" widget="many2many_tags"/>
                    <field name="semen_diagnosis_id" string="Diagnosis"/>
                    <field name="total_count" string="Count (x10^6/ml)"/>
                    <field name="motility" string="Motility (%)"/>
                    <field name="normal" string="Normal forms (%)"/>
                    <field name="acrosomal_cap" string="Acrosome defect (%)"/>
                    <field name="motility_percentage" string="Prep Motility (%)"/>
                    <field name="after_24_hrs_motility_percentage" string="24h survival of prep (%)"/>
                    <field name="sperm_cryopreservation_consented" string="Freezing recommended?"/>
                    <field name="other_observation" string="Patient Report 1" class="truncate_text"/>
                    <field name="comments" string="Patient Report 2" class="truncate_text"/>
                    <field name="special_notes" string="Special notes" class="truncate_text"/>
                </tree>
            </field>
        </record>

        <record id="ec_semen_analysis_tree_read_only_view" model="ir.ui.view">
            <field name="name">ec.semen.analysis.tree.readonly.view</field>
            <field name="model">ec.semen.analysis</field>
            <field name="priority">20</field>
            <field name="arch" type="xml">
                <tree  edit="0" create="0">
<!--                    <field name="semen_patient_id"/>-->
                    <field name="date"/>
                    <field name="lab_number"/>
                    <field name="preparation_ids" string="Type of analysis" widget="many2many_tags"/>
                    <field name="semen_diagnosis_id" string="Diagnosis"/>
                    <field name="total_count" string="Count (x10^6/ml)"/>
                    <field name="motility" string="Motility (%)"/>
                    <field name="normal" string="Normal forms (%)"/>
                    <field name="acrosomal_cap" string="Acrosome defect (%)"/>
                    <field name="motility_percentage" string="Prep Motility (%)"/>
                    <field name="after_24_hrs_motility_percentage" string="24h survival of prep (%)"/>
                    <field name="sperm_cryopreservation_consented" string="Freezing recommended?"/>
                    <field name="other_observation" string="Patient Report 1" class="truncate_text"/>
                    <field name="comments" string="Patient Report 2" class="truncate_text"/>
                    <field name="special_notes" string="Special notes" class="truncate_text"/>
                    <button name="edit_semen_analysis_record"
                            type="object"
                            groups="ecare_medical_history.group_medical_history_andrology_view"
                            string="View"
                            class="repeat_kanban_button"/>
                </tree>
            </field>
        </record>

        <!-- Explicit action -->
        <record id="ec_semen_analysis_create_action" model="ir.actions.act_window">
            <field name="name">Semen Analysis</field>
            <field name="res_model">ec.semen.analysis</field>
            <field name="view_mode">form</field>
            <field name="target">current</field>
        </record>
        <record id="ec_semen_analysis_action" model="ir.actions.act_window">
            <field name="name">Semen Analysis</field>
            <field name="res_model">ec.semen.analysis</field>
            <field name="view_mode">tree,form</field>
            <field name="target">current</field>
        </record>


        <menuitem id="ec_medical_history_semen_analysis"
                  name="Semen Analysis"
                  parent="ec_medical_history_andrology"
                  sequence="100"/>

        <menuitem id="ec_medical_history_semen_analysis_all"
                  name="Semen Analysis"
                  parent="ec_medical_history_semen_analysis"
                  action="ecare_medical_history.ec_semen_analysis_action"
                  sequence="110"/>

    </data>
</odoo>