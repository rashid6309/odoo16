<?xml version="1.0" encoding="utf-8"?>
<odoo>

    <data>
        <report
                id="ec_semen_analysis_report_patient_report"
                model="ec.semen.analysis"
                string="Semen Analysis - Patient Report"
                report_type="qweb-html"
                name="ecare_medical_history.ec_semen_analysis_patient_report_doc"
                file="Semen Analysis Report"/>

        <template id="ec_semen_analysis_patient_report_doc">
            <t t-call="web.html_container">
                <t t-call="ecare_medical_history.custom_header_footer"/>

                <t t-foreach="docs" t-as="o">
                    <table style="width: 100%;">
                        <tr>
                            <td style="padding-top:1%;text-align: right;" colspan="4">
                                <b style="display: list-item;"><span t-field="o.semen_patient_id.mr_num"/></b>
                                <span t-field="o.semen_patient_id.name"/>                          </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <b>Date:</b> <span t-field="o.date"/>
                            </td>
                            <td colspan="2">
                                <b>Lab No.:</b> <span t-field="o.lab_number"/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <b>Preparation:</b>
                                <t t-foreach="o.preparation_ids" t-as="item">
                                    <span style="margin-right:5%;"><t t-esc="item.name"/></span>
                                </t>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <b>Sample Produced at Lab:</b> <span t-field="o.sample_produced_at_lab"/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <b>Repeat Semen Analysis:</b> <span t-field="o.repeat_semen_analysis"/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <b>Freezing:</b> <span t-field="o.freezing"/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Abstinence:
                            </td>
                            <td>
                                <span t-field="o.abstinence"/><span> days (Range:3-5)</span>
                            </td>
                            <td>
                                Liquefaction Time:
                            </td>
                            <td>
                                <span t-field="o.liquifaction_time"/>
                            </td>
                        </tr>

                        <tr>
                            <td>
                                Color:
                            </td>
                            <td>
                                <span t-field="o.color"/><span> days (Range:3-5)</span>
                            </td>
                            <td>
                                PH:
                            </td>
                            <td>
                                <span t-field="o.ph"/><span> (Range:7.2-8.2)</span>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Viscosity:
                            </td>
                            <td>
                                <span t-field="o.viscosity"/>
                            </td>
                            <td>
                                Volume:
                            </td>
                            <td>
                                <span t-field="o.volume"/>
                                <span> ml (Range: 1.5 - 5)</span>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Total Count:
                            </td>
                            <td colspan="3">
                                <span t-field="o.total_count"/><span> million/ml (Range: <img width="13" height="23" src="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCAAXAA0DASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9MrjxZotjrKaRcanBDqckZljtpHCsUHUjP1FbUB3RqQdwIyDXyx+17q2oahqul+H4/BV1q1pj7W2sRaVLfrCV6IEjZSGOeuccdK9r+BUizfDfTWDauw5GNbgME6+2w8hR2z2pQ2Jlud5iTIwAAepqRVwKKKI6Ib1P/9kA"/> 20)</span>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Motility:
                            </td>
                            <td colspan="3">
                                <span t-field="o.motility"/><span> % (Range: <img width="13" height="23" src="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCAAXAA0DASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9MrjxZotjrKaRcanBDqckZljtpHCsUHUjP1FbUB3RqQdwIyDXyx+17q2oahqul+H4/BV1q1pj7W2sRaVLfrCV6IEjZSGOeuccdK9r+BUizfDfTWDauw5GNbgME6+2w8hR2z2pQ2Jlud5iTIwAAepqRVwKKKI6Ib1P/9kA"/> 40)</span>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="4">
                                <h3>Microscopic</h3>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                WBCs:
                            </td>
                            <td>
                                <span t-field="o.wbcs"/><span> /HPF</span>
                            </td>
                            <td>
                                Agglutination:
                            </td>
                            <td>
                                <span t-field="o.agglutination"/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Debris:
                            </td>
                            <td>
                                <span t-field="o.debris"/>
                            </td>
                            <td>
                                Bacteria:
                            </td>
                            <td>
                                <span t-field="o.bacteria"/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                EPI Cells/Immature Cells:
                            </td>
                            <td colspan="3">
                                <span t-field="o.epi_cells_immature_cells"/><span> /HPF</span>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                Other Observation:
                            </td>
                            <td colspan="3">
                                <span t-field="o.other_observation"/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="2">
                                <h3>Preparation Method:</h3>
                            </td>
                            <td colspan="2">
                                <h3><span t-field="o.method"/></h3>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <b>Prep Con:</b>
                            </td>
                            <td colspan="3">
                                <span t-field="o.prep_conc"/><span> million/ejaculate (Normal 20 x 10<sup>6</sup>/Ejaculate)</span>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                % Motility:
                            </td>
                            <td>
                                <span t-field="o.motility_percentage"/><span> % (<img width="13" height="23" src="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCAAXAA0DASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9MrjxZotjrKaRcanBDqckZljtpHCsUHUjP1FbUB3RqQdwIyDXyx+17q2oahqul+H4/BV1q1pj7W2sRaVLfrCV6IEjZSGOeuccdK9r+BUizfDfTWDauw5GNbgME6+2w8hR2z2pQ2Jlud5iTIwAAepqRVwKKKI6Ib1P/9kA"/> 75%)</span>
                            </td>
                            <td>
                                Progression:
                            </td>
                            <td>
                                <span t-field="o.progression"/>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="4">
                                <b>After 24hrs</b>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                % Motility:
                            </td>
                            <td>
                                <span t-field="o.after_24_hrs_motility_percentage"/><span> % (<img width="13" height="23" src="data:image/jpg;base64,/9j/4AAQSkZJRgABAQEAYABgAAD/2wBDAAMCAgMCAgMDAwMEAwMEBQgFBQQEBQoHBwYIDAoMDAsKCwsNDhIQDQ4RDgsLEBYQERMUFRUVDA8XGBYUGBIUFRT/2wBDAQMEBAUEBQkFBQkUDQsNFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBQUFBT/wAARCAAXAA0DASIAAhEBAxEB/8QAHwAAAQUBAQEBAQEAAAAAAAAAAAECAwQFBgcICQoL/8QAtRAAAgEDAwIEAwUFBAQAAAF9AQIDAAQRBRIhMUEGE1FhByJxFDKBkaEII0KxwRVS0fAkM2JyggkKFhcYGRolJicoKSo0NTY3ODk6Q0RFRkdISUpTVFVWV1hZWmNkZWZnaGlqc3R1dnd4eXqDhIWGh4iJipKTlJWWl5iZmqKjpKWmp6ipqrKztLW2t7i5usLDxMXGx8jJytLT1NXW19jZ2uHi4+Tl5ufo6erx8vP09fb3+Pn6/8QAHwEAAwEBAQEBAQEBAQAAAAAAAAECAwQFBgcICQoL/8QAtREAAgECBAQDBAcFBAQAAQJ3AAECAxEEBSExBhJBUQdhcRMiMoEIFEKRobHBCSMzUvAVYnLRChYkNOEl8RcYGRomJygpKjU2Nzg5OkNERUZHSElKU1RVVldYWVpjZGVmZ2hpanN0dXZ3eHl6goOEhYaHiImKkpOUlZaXmJmaoqOkpaanqKmqsrO0tba3uLm6wsPExcbHyMnK0tPU1dbX2Nna4uPk5ebn6Onq8vP09fb3+Pn6/9oADAMBAAIRAxEAPwD9MrjxZotjrKaRcanBDqckZljtpHCsUHUjP1FbUB3RqQdwIyDXyx+17q2oahqul+H4/BV1q1pj7W2sRaVLfrCV6IEjZSGOeuccdK9r+BUizfDfTWDauw5GNbgME6+2w8hR2z2pQ2Jlud5iTIwAAepqRVwKKKI6Ib1P/9kA"/>50%)</span>
                            </td>
                            <td>
                                Progression:
                            </td>
                            <td>
                                <span t-field="o.after_24_hrs_progression"/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <b>Comments:</b>
                            </td>
                            <td colspan="3">
                                <span t-field="o.comments"/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <b>Suitable for:</b>
                            </td>
                            <td colspan="3">
                                <t t-foreach="o.suitable_for_ids" t-as="item">
                                    <span t-field="item.name"/>
                                </t>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <b>Sperm Cryopreservation:</b>
                            </td>
                            <td>
                                Consented:
                            </td>
                            <td>
                                <span t-if="o.sperm_cryopreservation_consented">Yes</span><span t-if="not o.sperm_cryopreservation_consented">No</span>
                            </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                No. straws:
                            </td>
                            <td>
                                <span t-field="o.sperm_cryopreservation_strawe"/>
                            </td>
                        </tr>
                        <tr>
                            <td></td>
                            <td>
                                Storage Code:
                            </td>
                            <td>
                                <span t-field="o.sperm_cryopreservation_code"/>
                            </td>
                        </tr>
                        <tr>
                            <td>
                                <b>Semenologist:</b>
                            </td>
                            <td colspan="3">
                                <span t-field="o.seminologist"/>
                            </td>
                        </tr>
                    </table>
                </t>
            </t>
        </template>
    </data>
</odoo>